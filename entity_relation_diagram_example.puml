@startuml user_requests_erd_example
'Версия: 1.0
'Автор: Окунев Е.Е. (okunev.evgeni@gmail.com)

!function $autogenerated($a)
!return "<color:RoyalBlue>" + $a + " <<autogenerated PK>></color>"
!endfunction

!function $unique($a)
!return "<color:Crimson>" + $a + " <<unique>></color>"
!endfunction

!function $setBold($a)
!return "<b>" + $a + " </b>"
!endfunction

skinparam BackgroundColor SeaShell
skinparam LegendBackgroundColor MistyRose
skinparam LegendBorderColor PaleVioletRed
skinparam LegendFontColor PaleVioletRed

skinparam Class {
    HeaderBackgroundColor PaleGreen
}

'skinparam linetype ortho
skinparam TitleFontColor Sienna

Header Пример ER-диаграммы
Title ER-диаграмма "Заявка пользователя"

entity "$setBold("Пользователь (users)")" as users {
    * $autogenerated("id : uuid")
    ..
    * $unique("username : string(50)")
    * password : string(50)
    * name : string(200)
    * surname : string(200)
    patronimyc : string(200)
    * email : string(100)
    is_active : boolean <<default true>>
    birth_date : date
    created_at : timestamp
    updated_at: timestamp
}

entity "$setBold("Заявка (requests)")" as requests {
    * $autogenerated("id : uuid")
    ..
    * auhor_id : uuid <<users.uuid FK>>
    * service_id : int <<service.id FK>>
    * status_id : int <<statuses>>
    * description : text
    attached_file_id : uuid <<files.uuid FK>>
    created_at : timestamp
    created_by : uuid <<user.uuid FK>>
    updated_at : timestamp
    updated_by : <<user.uuid FK>>
}

entity "$setBold("Сервис (services)")" as services {
    * $autogenerated("id : int")
    ..
    * name : string(200)
    * is_enable : boolean <<default true>>
    default_route : json
}

entity "$setBold("Вложение (files)")" as files {
    * $autogenerated("id : uuid")
    ..
    * size: int
    * name: string(200)
    * url: string(500)
    mime_type: string(200)
    created_at : timestamp
    created_by : uuid <<user.uuid FK>>
    updated_at : timestamp
    updated_by : <<user.uuid FK>>    
}

entity "$setBold("Статус (statuses)")" as statuses {
    * $autogenerated("id : int")
    ..
    * name : string(200)
}

users::id ||-o{ requests::auhor_id : создает
users::id ||-o{ requests::updated_by : изменяет
users::id ||-----o{ requests::created_by

requests::service_id }o-down-|| services::id : принадлежит
requests::status_id }o-up-|| statuses::id
requests::attached_file_id ||-right-o| files::id


legend right
$setBold("Условные обозначения:")
* - обязательное поле
PK - первичный ключ
FK - внешний ключ
end legend

footer Evgeni Okunev, 2023

@enduml